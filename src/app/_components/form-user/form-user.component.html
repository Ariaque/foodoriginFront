<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
      xmlns="http://www.w3.org/1999/html">
<form (ngSubmit)="submit()">
<div class="main-div" fxLayoutAlign="space-around center" fxFlexFill *ngIf ="step == 1">
  <mat-card fxFlex="50">
    <mat-card-title class="title" >Informations générales</mat-card-title>
    <form [formGroup]="myForm" #infosForm="ngForm" name="form" (ngSubmit)="infosForm.resetForm()">
      <div class="form-group col-md-12">
        <label for="description">Description</label>
        <textarea class="form-control" id="description" placeholder="Saisissez la présentation de votre entreprise" lang="fr" style="resize: none" rows="3" [(ngModel)]="description" [ngModelOptions]="{standalone:true}">
        {{this.description}}</textarea>
      </div>
      <div class="form-group col-md-8">
        <label for="nombre_employes">Nombre d'employés </label>
        <input type="number" [min]="1"  class="form-control" id="nombre_employes" [(ngModel)]="nbEmployes" [ngModelOptions]="{standalone:true}" (keypress)="validate($event)">
      </div>
      <div>
        <label for="siteW" class="padding-block">Lien vers le site web </label>
      </div>
      <div class="input-icone padding-block no-padding">
        <i class="fa fa-globe icone-size" aria-hidden="true"></i>
        <input formControlName="siteW" [ngClass]="{
          'form-control':true,
          'is-invalid':!siteW.valid && siteW.touched,
          'is-valid': siteW.valid }" type="text" class="form-control" id="siteW" name="siteW"  placeholder="Ex. http://www.expl.com/" [(ngModel)]="lienSite" [ngModelOptions]="{standalone:true}">
          <small *ngIf= "siteW.errors?.required && siteW.touched" class="form-text custom-invalid-feedback" >Le lien est requis</small>
          <small *ngIf= "siteW.errors?.pattern && siteW.touched" class="form-text custom-invalid-feedback" >Saisir un lien valide </small>
        </div>
      <div class="form-group col-md-12">
        <mat-checkbox class="example-margin" [(ngModel)]="appartientGroupe" [ngModelOptions]="{standalone:true}">Appartient à un groupe</mat-checkbox>
      </div>
      <div class="form-group col-md-12" *ngIf="appartientGroupe">
        <label for="siret_groupe">Siret du groupe</label>
        <input type="text" class="form-control" id="siret_groupe" placeholder="Siret du groupe" [(ngModel)]="siretGroupe" [maxLength]="14" [ngModelOptions]="{standalone:true}">
        <small *ngIf= "this.siretGroupe.length < 14" class="form-text custom-invalid-feedback" >Le numéro siret doit comporter 14 caractères </small>
      </div>
      <div class="form-group col-md-12">
        <label for = "labels"> Labels </label>
        <mat-select id="labels" name="labels" placeholder="Selectionnez vos labels" [formControl]="listLabel" multiple class="form-control">
          <mat-option *ngFor="let label of this.labels" [value]="label">{{label.libelle}}</mat-option>
        </mat-select>
      </div>
      <div class="form-group col-md-12">
        <label for = "certificat">Certifications </label>
        <mat-select id="certificat" name="certificat" class="form-control" placeholder="Selectionnez vos certifications" [formControl]="listCertif" multiple>
          <mat-option *ngFor="let certif of this.certifications" [value]="certif">{{certif.libelle}}</mat-option>
        </mat-select>
      </div>
    </form>
  </mat-card>
  <IMG SRC="assets/images/enSavoirPlusExplication.png" class="knowMoreImg"/>
</div>
<div class="main-div" fxLayoutAlign="space-around center" fxFlexFill *ngIf ="step == 2">
  <mat-card fxFlex="50">
      <form #rsForm="ngForm" (ngSubmit)="rsForm.resetForm()" [formGroup]="myForm" name="form">
      <mat-card-title class="title" >Réseaux sociaux </mat-card-title>
      <div class="input-icone">
        <i class="fa fa-facebook-square icone-size" aria-hidden="true"></i>
        <input formControlName="lienF" [ngClass]="{
          'form-control':true,
          'is-invalid':!lienF.valid && lienF.touched,
          'is-valid': lienF.valid }" type="text" class="form-control" id="facebook" name="lienF" placeholder="Lien Facebook    Ex. https://www.facebook.com/" [(ngModel)]="lienFacebook" [ngModelOptions]="{standalone:true}">
          <small *ngIf= "lienF.errors?.required && lienF.touched" class="form-text custom-invalid-feedback" >Le lien est requis</small>
          <small *ngIf= "lienF.errors?.pattern && lienF.touched" class="form-text custom-invalid-feedback" >Saisir un lien valide </small>
        </div>
      <div class="input-icone">
        <i class="fa fa-twitter-square icone-size" aria-hidden="true"></i>
        <input formControlName="lienT" [ngClass]="{
          'form-control':true,
          'is-invalid':!lienT.valid && lienT.touched,
          'is-valid': lienT.valid }" type="text" class="form-control" name="lienT" id="twitter" placeholder="Lien Twitter         Ex.https://twitter.com/" [(ngModel)]="lienTwitter" [ngModelOptions]="{standalone:true}">
          <small *ngIf= "lienT.errors?.required && lienT.touched" class="form-text custom-invalid-feedback" >Le lien est requis</small>
          <small *ngIf= "lienT.errors?.pattern && lienT.touched" class="form-text custom-invalid-feedback" >Saisir un lien valide </small>
        </div>
      <div class="input-icone">
        <i class="fa fa-instagram icone-size" aria-hidden="true"></i>
        <input formControlName="lienI" [ngClass]="{
          'form-control':true,
          'is-invalid':!lienI.valid && lienI.touched,
          'is-valid': lienI.valid }" type="text" class="form-control" name="lienI" type="text" class="form-control" id="instagram" placeholder="Lien Instagram    Ex.https://www.instagram.com/" [(ngModel)]="lienInsta" [ngModelOptions]="{standalone:true}">
          <small *ngIf= "lienI.errors?.required && lienI.touched" class="form-text custom-invalid-feedback" >Le lien est requis</small>
          <small *ngIf= "lienI.errors?.pattern && lienI.touched" class="form-text custom-invalid-feedback" >Saisir un lien valide </small>
        </div>
    </form>
  </mat-card>
    <IMG SRC="assets/images/enSavoirPlusExplication.png" class="knowMoreImg"/>
</div>

<div class="main-div"  fxLayoutAlign="space-around center" fxFlexFill *ngIf ="step == 3">
  <mat-card fxFlex="50">
    <mat-card-title class="title" >Gestion des médias</mat-card-title>
    <h2> Images </h2>
    <div>
      <h4> Sélectionnez une ou plusieurs images : </h4>
      <form #imagesForm="ngForm">
        <input type="file" accept="image/*" multiple (change)="onFileChanged($event)">
        <button (click)="this.onUpload()" class="btn btn-primary" > Valider </button>
      </form>
    </div>
    <div>
      <h2 *ngIf="imagesLink.length > 0"> Images sauvegardées : </h2>
      <div *ngFor="let link of imagesLink">
        <img [src]="link" width="300" height="200">
        <button class="btn btn-danger" (click)="deleteImage(link)"style="margin-left: 25px"> Supprimer </button>
      </div>
    </div>
  </mat-card>
    <IMG SRC="assets/images/enSavoirPlusExplication.png" class="knowMoreImg"/>
</div>
<div class="main-div"  fxLayoutAlign="space-around center" fxFlexFill *ngIf ="step == 4">
  <mat-card fxFlex="50">
    <mat-card-title class="title" >Gestion des médias</mat-card-title>
    <div>
      <h2> Vidéos </h2>
      <h4> Saisissez le(s) lien(s) des vidéos que vous souhaitez renseigner: </h4>
      <form [formGroup]="urlVideoForm">
        <button type="button" (click)="addUrl()" class="btn btn-primary position-bouton"> Ajouter lien </button>
        <table class="table borderless" formArrayName="urls">
          <tr *ngFor="let url of urls().controls |slice:0:10; let i = index" [formGroupName]="i">
            <td>
              <label for="urlV"> Lien vers la video*: </label>
              <input [ngClass]="{
                'form-control':true, 
                'is-invalid':!url.controls.libelle.valid && url.controls.libelle.touched,
                'is-valid': url.controls.libelle.valid }" type="text" name="libelle" formControlName="libelle" class="form-control" id="urlV" name="libelle" placeholder="Ex. http://www.expl.com/">
                <small *ngIf= "url.controls.libelle.errors?.required && url.controls.libelle.touched" class="form-text custom-invalid-feedback" >Le lien est requis</small>
                <small *ngIf= "url.controls.libelle.errors?.pattern && url.controls.libelle.touched" class="form-text custom-invalid-feedback" >Saisir un lien valide </small>      
              </td>
            <td>
              <label for="titreV"> Titre de la vidéo*: </label>
              <input type="text" formControlName="titre" [ngClass]="{'form-control':true,'is-invalid': url.controls.titre.errors && url.controls.titre.touched}" class="form-control" id="titreV" name="titreV">
              <small *ngIf="url.controls.titre.errors?.required && url.controls.titre.touched" class="form-text custom-invalid-feedback">Titre est requis</small>           
            </td>
            <td class="center-element">
              <button (click)="removeUrl(i)" class="btn btn-danger" style="margin-top: 25px"> Supprimer </button>
            </td>
          </tr>
        </table>
    </form>
    *Champ obligatoire 
    </div>
  </mat-card>
    <IMG SRC="assets/images/enSavoirPlusExplication.png" class="knowMoreImg"/>
</div>
<div class="main-div"  fxLayoutAlign="space-around center" fxFlexFill *ngIf ="step == 5">
  <mat-card fxFlex="50">
    <mat-card-title class="title"> Agriculteurs/Fermes Partenaires </mat-card-title>
    <h4> Saisissez le(s) ferme(s)/agriculteur(s) partenaires que vous souhaitez renseigner: </h4>
    <form [formGroup]="fermeForm">
      <button type="button" (click)="addFerme()" class="btn btn-primary" style="float: right"> Ajouter</button>
      <table class="table borderless" formArrayName="fermes">
        <tr *ngFor="let ferme of fermes().controls |slice:0:5; let i = index" [formGroupName]="i">
          <td>
            <div class="form-group col-md-12">
              <label for="nomF"> Nom*: </label>
              <input [ngClass]="{'form-control':true,'is-invalid': ferme.controls.nom.errors && ferme.controls.nom.touched}" type="text" formControlName="nom" id="nomF" name="nomF" class="form-control" placeholder="Saisissez le nom de la ferme/l'agriculteur">
              <small *ngIf="ferme.controls.nom.errors?.required && ferme.controls.nom.touched" class="form-text custom-invalid-feedback">Nom est requis</small>           
            </div>
            <div class="form-group col-md-12">
              <label for="presentationF"> Presentation: </label>
             <textarea class="form-control" placeholder="Saisissez la description de la ferme/l'agriculteur" lang="fr" style="resize: none" rows="2" cols="45" type="text" formControlName="presentation" id="presentationF" name="presentationF"></textarea>
            </div>
            <div class="form-group col-md-12">
              <label for="urlF"> Lien vers le site web de la ferme*: </label>
              <input [ngClass]="{'form-control':true, 
              'is-invalid':!ferme.controls.url.valid && ferme.controls.url.touched,
              'is-valid': ferme.controls.url.valid }" type="text" formControlName="url" id="urlF" name="urlF" class="form-control" placeholder="Ex. http://www.expl.com/">
              <small *ngIf= "ferme.controls.url.errors?.required && ferme.controls.url.touched" class="form-text custom-invalid-feedback" >Le lien est requis</small>
              <small *ngIf= "ferme.controls.url.errors?.pattern && ferme.controls.url.touched" class="form-text custom-invalid-feedback" >Saisir un lien valide </small>      
            </div>
            <button (click)="removeFerme(i)" class="btn btn-danger position-bouton"> Supprimer </button>
          </td>
        </tr>
      </table>
    </form>
    *Champ obligatoire 
  </mat-card>
    <IMG SRC="assets/images/enSavoirPlusExplication.png" class="knowMoreImg"/>
</div>
<div class="main-div"  fxLayoutAlign="space-around center" fxFlexFill *ngIf ="step == 6">
  <mat-card fxFlex="50">
    <mat-card-title class="title"> Denrées animales utilisées </mat-card-title>
    <h4> Saisissez les denrées animales utilisées et leurs origines </h4>
    <form [formGroup]="denreeForm">
      <button type="button" (click)="addDenree()" class="btn btn-primary" style="float: right"> Ajouter</button>
      <table class="table borderless" formArrayName="denrees">
        <tr *ngFor="let denree of denrees().controls |slice:0:10; let i = index" [formGroupName]="i">
          <td>
              <label for="nomD"> Type de denrée*: </label>
              <input type="text" [ngClass]="{'form-control':true,'is-invalid': denree.controls.nom.errors && denree.controls.nom.touched}" formControlName="nom" id="nomD" name="nomD" class="form-control">
              <small *ngIf="denree.controls.nom.errors?.required && denree.controls.nom.touched" class="form-text custom-invalid-feedback">Nom est requis</small> 
            </td>
          <td>
              <label for="origineD"> Origine de la denrée: </label>
              <input type="text" formControlName="origine" id="origineD" name="origineD" class="form-control">
          </td>
          <td>
            <button (click)="removeDenree(i)" class="btn btn-danger" style="margin-top: 25px"> Supprimer </button>
          </td>
        </tr>
      </table>
    </form>
    *Champ obligatoire 
  </mat-card>
    <IMG SRC="assets/images/enSavoirPlusExplication.png" class="knowMoreImg"/>
</div>
<div class="btn"  fxLayoutAlign="space-around center" fxFlexFill>
  <mat-card fxFlex="20" class="butt">
<a class ="btn btn-primary mx-2" (click)= "previous()" *ngIf="step != 1">Précédent</a>
<button type ="submit" class=" btn btn-primary mx-2"  *ngIf="step != 6">Suivant</button>
<button mat-raised-button type ="submit" (click)="saveInfos()" color="warn" *ngIf="step == 6" mat-stroked-button>Valider</button>
</mat-card>
</div>
</form>
